---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
# image will be published to ghcr.io/<user>/<name>
name: lightblue
# description will be included in the image's metadata
description: My customized immutable system based on Fedora Silverblue.

# the base image to build on top of (FROM) and the version tag to use
base-image: quay.io/fedora-ostree-desktops/silverblue
image-version: 42 # latest is also supported if you want new updates ASAP

# module configuration, executed in order
# you can include multiple instances of the same module
modules:
  - type: files
    files:
      - source: system
        destination: / # copies files/system/* (* means everything inside it) 
        # into your image's root folder /
        
  - type: dnf
    repos:
      keys:
        - https://brave-browser-rpm-release.s3.brave.com/brave-core.asc
        - https://packages.microsoft.com/keys/microsoft.asc
      files:
        - https://brave-browser-rpm-release.s3.brave.com/brave-browser.repo
        - https://github.com/terrapkg/subatomic-repos/raw/main/terra.repo
      copr: 
        - atim/starship
        - atim/bottom
        - harryjph/fonts
      nonfree: rpmfusion
      cleanup: true
    optfix:
      - brave.com
    install:
      packages:
        - terra-release
        - brave-browser
        - flatpak
        - dnf-plugins-core
        - fish
        - gitui
        - bat
        - mpv
        - starship
        - bottom
        - fastfetch
        - code
        - docker
        - docker-compose
        - gnome-tweaks
        - gnome-shell-extension-appindicator
        - helix
        - discord
        - mission-center
        - chezmoi
        - zoxide
        - fzf
    remove:
      packages:
        - gnome-tour
        - gnome-initial-setup
        - gnome-system-monitor
        - gnome-shell-extension-apps-menu
        - gnome-shell-extension-launch-new-instance
        - gnome-shell-extension-places-menu
        - gnome-shell-extension-window-list
        - gnome-classic-session
        - fedora-third-party
        - fedora-flathub-remote
        - fedora-workstation-repositories
      auto-remove: true

  - type: systemd
    system:
      enabled:
        - docker

  - type: fonts
    fonts:
      nerd-fonts:
        - JetBrainsMono
      google-fonts:
        - Noto Sans

  - type: default-flatpaks
    configurations:
      - notify: true # Send notification after install/uninstall is finished 
        # (true/false)
        scope: system
        # If no repo information is specified, Flathub will be used by default
        install: # system flatpaks we want all users to have and not remove
          - com.github.tchx84.Flatseal
          - com.spotify.Client
      - scope: user # Also add Flathub user repo, but no user packages

  - type: gnome-extensions
    install:
      - Night Theme Switcher

  - type: signing # this sets up the proper policy & signing files for signed 
    # images to work fully
